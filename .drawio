<mxfile host="app.diagrams.net">
  <diagram name="ScholarAI System Diagram">
    <mxGraphModel>
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Source Control & CI/CD -->
        <mxCell id="git" value="GitHub" style="shape=mxgraph.social.github;verticalLabelPosition=bottom;verticalAlign=top;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="20" y="20" width="60" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="gha" value="GitHub Actions" style="rounded=1;fillColor=#FFF2CC;strokeColor=#D6B656;" vertex="1" parent="1">
          <mxGeometry x="100" y="30" width="120" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="dockerhub" value="Docker Hub" style="shape=mxgraph.social.docker;verticalLabelPosition=bottom;verticalAlign=top;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="250" y="20" width="60" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="cicd_edge1" edge="1" source="git" target="gha" parent="1" style="endArrow=block;strokeColor=#000000;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="cicd_edge2" edge="1" source="gha" target="dockerhub" parent="1" style="endArrow=block;strokeColor=#000000;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="deploy" value="Cloud Deployment" style="ellipse;fillColor=#E8F8F5;strokeColor=#17A589;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="330" y="30" width="120" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="cicd_edge3" edge="1" source="dockerhub" target="deploy" parent="1" style="endArrow=block;strokeColor=#000000;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Frontend -->
        <mxCell id="frontend" value="Frontend UI (Next.js)" style="rounded=1;fillColor=#DAE8FC;strokeColor=#6C8EBF;" vertex="1" parent="1">
          <mxGeometry x="80" y="120" width="140" height="60" as="geometry"/>
        </mxCell>

        <!-- Spring Boot Backend -->
        <mxCell id="springboot" value="Spring Boot Backend" style="rounded=1;fillColor=#D5E8D4;strokeColor=#82B366;" vertex="1" parent="1">
          <mxGeometry x="280" y="120" width="160" height="60" as="geometry"/>
        </mxCell>
        <!-- Auth Service inside Spring Boot -->
        <mxCell id="auth" value="Auth Service" style="rounded=1;fontSize=10;fillColor=#FFFFFF;strokeColor=#000000;" vertex="1" parent="springboot">
          <mxGeometry x="10" y="10" width="60" height="20" as="geometry"/>
        </mxCell>
        <!-- Project Service inside Spring Boot -->
        <mxCell id="project" value="Project Service" style="rounded=1;fontSize=10;fillColor=#FFFFFF;strokeColor=#000000;" vertex="1" parent="springboot">
          <mxGeometry x="80" y="10" width="70" height="20" as="geometry"/>
        </mxCell>
        <!-- Task Service inside Spring Boot -->
        <mxCell id="task" value="Task Service" style="rounded=1;fontSize=10;fillColor=#FFFFFF;strokeColor=#000000;" vertex="1" parent="springboot">
          <mxGeometry x="10" y="35" width="60" height="20" as="geometry"/>
        </mxCell>

        <!-- FastAPI AI Agent Backend -->
        <mxCell id="fastapi" value="FastAPI AI Agent Backend" style="rounded=1;fillColor=#FFE6CC;strokeColor=#D79B00;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="500" y="100" width="260" height="200" as="geometry"/>
        </mxCell>
        <!-- Internal agent boxes -->
        <mxCell id="agents_grp" value="" vertex="1" parent="fastapi" connectable="0">
          <mxGeometry x="10" y="10" width="240" height="180" as="geometry"/>
        </mxCell>
        <!-- Agent cells -->
        <mxCell id="agent1" value="WebSearch Agent" style="rounded=1;fontSize=10;fillColor=#FFF7E6;strokeColor=#D79B00;" vertex="1" parent="agents_grp">
          <mxGeometry x="10" y="10" width="100" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="agent2" value="Scraper Agent" style="rounded=1;fontSize=10;fillColor=#FFF7E6;strokeColor=#D79B00;" vertex="1" parent="agents_grp">
          <mxGeometry x="130" y="10" width="100" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="agent3" value="Summarizer Agent" style="rounded=1;fontSize=10;fillColor=#FFF7E6;strokeColor=#D79B00;" vertex="1" parent="agents_grp">
          <mxGeometry x="10" y="55" width="100" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="agent4" value="Critic Agent" style="rounded=1;fontSize=10;fillColor=#FFF7E6;strokeColor=#D79B00;" vertex="1" parent="agents_grp">
          <mxGeometry x="130" y="55" width="100" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="agent5" value="Gap Analysis Agent" style="rounded=1;fontSize=10;fillColor=#FFF7E6;strokeColor=#D79B00;" vertex="1" parent="agents_grp">
          <mxGeometry x="10" y="100" width="100" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="agent6" value="Topic Suggestion Agent" style="rounded=1;fontSize=10;fillColor=#FFF7E6;strokeColor=#D79B00;" vertex="1" parent="agents_grp">
          <mxGeometry x="130" y="100" width="100" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="agent7" value="QA Agent" style="rounded=1;fontSize=10;fillColor=#FFF7E6;strokeColor=#D79B00;" vertex="1" parent="agents_grp">
          <mxGeometry x="10" y="145" width="100" height="30" as="geometry"/>
        </mxCell>

        <!-- External Services -->
        <mxCell id="academic_apis" value="Academic APIs&#xa;(Crossref, Semantic Scholar)" style="rounded=1;fillColor=#F8CECC;strokeColor=#B85450;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="500" y="320" width="180" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="calendar_api" value="Calendar API&#xa;(Google Calendar)" style="rounded=1;fillColor=#F8CECC;strokeColor=#B85450;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="700" y="320" width="180" height="40" as="geometry"/>
        </mxCell>

        <!-- Shared Supabase DB -->
        <mxCell id="supabase" value="Supabase DB&#xa;(PostgreSQL)" style="rounded=1;fillColor=#E1D5E7;strokeColor=#9673A6;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="300" y="320" width="180" height="60" as="geometry"/>
        </mxCell>

        <!-- Monitoring -->
        <mxCell id="prometheus" value="Prometheus" style="rounded=1;fillColor=#E8F6F3;strokeColor=#1ABC9C;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="500" y="380" width="100" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="grafana" value="Grafana" style="rounded=1;fillColor=#F4ECF7;strokeColor=#9B59B6;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="650" y="380" width="100" height="40" as="geometry"/>
        </mxCell>

        <!-- Main Data Flows -->
        <mxCell id="e1" value="HTTP" style="endArrow=block;strokeColor=#000000;" edge="1" source="frontend" target="springboot" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e2" value="gRPC / HTTP" style="endArrow=block;strokeColor=#000000;" edge="1" source="springboot" target="fastapi" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e3" value="Query/Update" style="endArrow=block;strokeColor=#000000;" edge="1" source="springboot" target="supabase" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e4" value="Agent Results â†’ DB" style="endArrow=block;strokeColor=#000000;" edge="1" source="fastapi" target="supabase" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e5" value="Paper Search" style="endArrow=block;strokeColor=#000000;" edge="1" source="fastapi" target="academic_apis" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e6" value="Calendar Sync" style="endArrow=block;strokeColor=#000000;" edge="1" source="springboot" target="calendar_api" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="edge_prom_sb" edge="1" source="springboot" target="prometheus" parent="1" style="endArrow=none;strokeDashpattern=5 5;strokeColor=#16A085;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="edge_prom_fa" edge="1" source="fastapi" target="prometheus" parent="1" style="endArrow=none;strokeDashpattern=5 5;strokeColor=#16A085;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="edge_graf" edge="1" source="prometheus" target="grafana" parent="1" style="endArrow=block;strokeColor=#9B59B6;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
